<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>雑学掲示板</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>
  <div class="container">
    <h1>雑学掲示板</h1>

    <div class="game-area">
      <img id="emerald-image" src="images/cookie.png" alt="クッキー画像" />
      <p>エメラルド数: <span id="emerald-count">0</span></p>
    </div>

    <h2>ショップ</h2>
    <div id="shop" class="shop-area"></div>

    <h2>インベントリ</h2>
    <div id="inventory" class="inventory-area"></div>

    <h2>ランキング</h2>
    <div id="ranking" class="ranking-area"><ol></ol></div>

    <h2>交流コーナー</h2>
    <div id="messages-area">
      <div id="talk-messages" class="messages" aria-live="polite"></div>

      <div id="name-area" style="margin:8px 0;">
        <input id="name-input" placeholder="名前を変更" />
        <button id="name-change-btn">名前を変更</button>

        <label for="avatar-select" class="avatar-select-label">アイコン変更</label>
        <select id="avatar-select"></select>
      </div>

      <form id="msg-form" action="#" onsubmit="return false;">
        <input type="text" id="msg-input" placeholder="メッセージを入力…" autocomplete="off" required />
        <button type="submit" id="msg-send">送信</button>
      </form>
    </div>
  </div>

  <!-- socket client loader: 動的に読み込み（まずサーバ経由の /s/socket.io.js を試し、失敗したら CDN） -->
  <script>
    (function loadSock() {
      const path = "/s/socket.io.js"; // サーバ側で socket.io の path を /s にしている
      const s = document.createElement("script");
      s.src = path;
      s.async = true;
      s.crossOrigin = "anonymous";
      s.onload = () => console.log("socket client loaded from", path);
      s.onerror = () => {
        const cdn = "https://cdn.socket.io/4.6.1/socket.io.min.js";
        const s2 = document.createElement("script");
        s2.src = cdn;
        s2.async = true;
        s2.crossOrigin = "anonymous";
        document.head.appendChild(s2);
      };
      document.head.appendChild(s);
    })();
  </script>

  <script defer src="script.js"></script>
</body>
</html>
